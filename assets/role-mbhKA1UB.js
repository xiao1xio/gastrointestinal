var Q=Object.defineProperty;var C=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var T=(a,n,t)=>n in a?Q(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,b=(a,n)=>{for(var t in n||(n={}))W.call(n,t)&&T(a,t,n[t]);if(C)for(var t of C(n))X.call(n,t)&&T(a,t,n[t]);return a};var w=(a,n,t)=>new Promise((k,m)=>{var f=i=>{try{c(t.next(i))}catch(r){m(r)}},_=i=>{try{c(t.throw(i))}catch(r){m(r)}},c=i=>i.done?k(i.value):Promise.resolve(i.value).then(f,_);c((t=t.apply(a,n)).next())});import{B as Y}from"./Table-DOhLsWZf.js";import{T as R}from"./TableAction-DjARIrkc.js";import{a_ as Z,a2 as K,aV as ee,d as te,u as ae,r as u,a as M,I as ne,ej as oe,o as le,y as se,h as B,g as o,w as l,j as v,i as y,a7 as D,em as ie,t as ue,N as ce,B as re,el as de,S as fe,a3 as pe}from"./index-DxMZejvi.js";import{_ as me}from"./CreateModal.vue_vue_type_script_setup_true_lang-CtNuRaX0.js";import{_ as _e}from"./EditModal.vue_vue_type_script_setup_true_lang-iGS1cTUh.js";import{P as ve}from"./PlusOutlined-DH-IsLQU.js";import"./vuedraggable.umd-DZPXDNVK.js";import"./useDesignSetting-H7UYKjl9.js";import"./SettingOutlined-DgMHfc0d.js";import"./propTypes-CPXDP53q.js";import"./FormOutlined-Cmu5kHGF.js";import"./ReloadOutlined-BNdEzWH-.js";import"./componentSetting-CQq0JJwW.js";import"./index-gCZ6ab40.js";import"./DownOutlined-BTakhg3t.js";import"./BasicForm-BKqInxHP.js";import"./UpOutlined-Bzrj6O9r.js";import"./useForm-8o9gVmdv.js";import"./useModal-BTzYGKVJ.js";function ye(a){return Z.Get("/role/list",{params:a})}const ke=[{title:"id",key:"id"},{title:"角色名称",key:"name"},{title:"说明",key:"explain"},{title:"是否默认角色",key:"isDefault",render(a){return K(ee,{type:a.isDefault?"success":"error"},{default:()=>a.isDefault?"是":"否"})}},{title:"创建时间",key:"create_date"}],he={class:"n-layout-page-header"},ge={class:"py-3 menu-list"},Pe=te({__name:"role",setup(a){const n=ae(),t=u(),k=u(),m=u(),f=u(!1),_=u(!1),c=u(!1),i=u(""),r=u([]),d=u([]),p=u(["console","step-form"]),A=M({name:"NaiveAdmin"}),N=M({width:250,title:"操作",key:"action",fixed:"right",render(e){return K(R,{style:"button",actions:[{label:"菜单权限",onClick:I.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"编辑",onClick:j.bind(null,e),ifShow:()=>!0,auth:["basic_list"]},{label:"删除",onClick:H.bind(null,e),ifShow:()=>!0,auth:["basic_list"]}]})}}),S=e=>w(this,null,function*(){let s=b(b({},y(A)),e);return yield ye(s)});function U(){k.value.openModal()}function V(e){console.log(e)}function E(){t.value.reload()}function $(e){e.preventDefault(),_.value=!0,setTimeout(()=>{f.value=!1,n.success("提交成功"),E(),_.value=!1},200)}function j(e){console.log("点击了编辑",e),m.value.showModal(e)}function H(e){console.log("点击了删除",e),n.info("点击了删除")}function I(e){i.value=`分配 ${e.name} 的菜单权限`,p.value=e.menu_keys,f.value=!0}function P(e){p.value=[p.value,...e]}function q(e){d.value=e}function F(){d.value.length?d.value=[]:d.value=r.value.map(e=>e.key)}function G(){c.value?(p.value=[],c.value=!1):(p.value=ie(r.value),c.value=!0)}return ne(()=>w(this,null,function*(){const e=yield oe();d.value=e==null?void 0:e.list.map(s=>s.key),r.value=e==null?void 0:e.list})),(e,s)=>{const x=ue,O=ce,h=re,z=de,J=fe,L=pe;return le(),se("div",null,[B("div",he,[o(x,{bordered:!1,title:"角色权限管理"},{default:l(()=>s[1]||(s[1]=[v(" 页面数据为 Mock 示例数据，非真实数据。 ")])),_:1})]),o(x,{bordered:!1,class:"mt-4 proCard"},{default:l(()=>[o(y(Y),{columns:y(ke),request:S,"row-key":g=>g.id,ref_key:"actionRef",ref:t,actionColumn:N,"onUpdate:checkedRowKeys":V},{tableTitle:l(()=>[o(h,{type:"primary",onClick:U},{icon:l(()=>[o(O,null,{default:l(()=>[o(y(ve))]),_:1})]),default:l(()=>[s[2]||(s[2]=v(" 新增角色 "))]),_:1})]),action:l(()=>[o(y(R))]),_:1},8,["columns","row-key","actionColumn"])]),_:1}),o(L,{show:f.value,"onUpdate:show":s[0]||(s[0]=g=>f.value=g),"show-icon":!1,preset:"dialog",title:i.value},{action:l(()=>[o(J,null,{default:l(()=>[o(h,{type:"info",ghost:"","icon-placement":"left",onClick:F},{default:l(()=>[v(" 全部"+D(d.value.length?"收起":"展开"),1)]),_:1}),o(h,{type:"info",ghost:"","icon-placement":"left",onClick:G},{default:l(()=>[v(" 全部"+D(c.value?"取消":"选择"),1)]),_:1}),o(h,{type:"primary",loading:_.value,onClick:$},{default:l(()=>s[3]||(s[3]=[v("提交")])),_:1},8,["loading"])]),_:1})]),default:l(()=>[B("div",ge,[o(z,{"block-line":"",cascade:"",checkable:"","virtual-scroll":!0,data:r.value,expandedKeys:d.value,"checked-keys":p.value,style:{"max-height":"950px",overflow:"hidden"},"onUpdate:checkedKeys":P,"onUpdate:expandedKeys":q},null,8,["data","expandedKeys","checked-keys"])])]),_:1},8,["show","title"]),o(me,{ref_key:"createModalRef",ref:k},null,512),o(_e,{ref_key:"editModalRef",ref:m},null,512)])}}});export{Pe as default};
